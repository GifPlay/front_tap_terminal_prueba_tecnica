<div class="mb-3 ml-3 mr-3 mt-3">
  <h2 mat-dialog-title>
    {{ data?.id ? 'Editar Usuario' : 'Nuevo Usuario' }}
  </h2>

  <form [formGroup]="form">
    <!-- Código -->
    <div *ngIf="data?.codigo">
      <label>Código:</label>
      <input class="form-control" formControlName="codigo" readonly />
    </div>

    <!-- Usuario (email) -->
    <div>
      <label>Correo electrónico:</label>
      <input type="email" class="form-control" formControlName="usuario" />
      <div *ngIf="form.get('usuario')?.invalid && form.get('usuario')?.touched" class="text-danger">
        Correo válido requerido
      </div>
    </div>

    <!-- Nombre -->
    <div>
      <label>Nombre:</label>
      <input class="form-control" formControlName="nombre" />
      <div *ngIf="form.get('nombre')?.invalid && form.get('nombre')?.touched" class="text-danger">
        Nombre requerido
      </div>
    </div>

    <!-- Teléfono -->
    <div>
      <label>Teléfono:</label>
      <input type="tel" class="form-control" formControlName="telefono" />
      <div *ngIf="form.get('telefono')?.invalid && form.get('telefono')?.touched" class="text-danger">
        Teléfono requerido
      </div>
    </div>

    <!-- Foto de perfil -->
   <div class="mt-3">
      <label>Foto de perfil:</label>
      <input type="file" (change)="onFileSelected($event)" />
      <img *ngIf="data?.fotoPerfil" [src]="'http://tapterminal.test/storage/fotos/' + data.fotoPerfil" width="120" class="mt-2" />
    </div>

    <!-- Password-->
    <div *ngIf="!data?.id">
      <label>Password:</label>
      <input type="password" class="form-control" formControlName="password" />
      <div *ngIf="form.get('password')?.invalid && form.get('password')?.touched" class="text-danger">
        Password requerido (mínimo 6 caracteres)
      </div>
    </div>

    <!-- Role -->
    <div>
      <label>Rol:</label>
      <select class="form-control" formControlName="role">
        <option value="admin">Admin</option>
        <option value="user">Usuario</option>
      </select>
    </div>

    <!-- Fechas -->
    <div *ngIf="data?.created_at">
      <label>Fecha de creación:</label>
      <input class="form-control" formControlName="created_at" readonly />
    </div>
    <div *ngIf="data?.updated_at">
      <label>Última actualización:</label>
      <input class="form-control" formControlName="updated_at" readonly />
    </div>

    <!-- Botones -->
    <div class="mt-3 d-flex justify-content-between">
      <button class="btn btn-outline-success" type="button" (click)="guardar()" [disabled]="form.invalid">
        Guardar
      </button>
      <button class="btn btn-outline-warning" type="button" (click)="eliminar()" *ngIf="data?.id">
        Eliminar
      </button>
      <button class="btn btn-outline-secondary" type="button" (click)="cerrar()">
        Cancelar
      </button>
    </div>
  </form>
</div>